# 小程序技术选型：原生 VS Taro

## 考虑点

小程序技术选型要结合业务场景、业务特点来进行考虑和评估，主要分为如下几点：

- 开发体验
- 框架本身的稳定性
- 社区支持
- 跨平台
- 潜在风险

### 开发体验

|            | 原生小程序                 | Taro                           | 结论                                                                                         |
| ---------- | -------------------------- | ------------------------------ | -------------------------------------------------------------------------------------------- |
| 模板       | wxml 字符串模板            | JSX                            | 前者几乎没有类型推导，后者可以做到很强的类型推导，两者学习成本对于有 MVVM 开发经验的人差不多 |
| 脚本语言   | ES6、TypeScript            | Typescript, ES6, ES7, ESnext   | 这点两者无太大差异                                                                           |
| 模块化     | CommonJS                   | ES6 模块化方案                 | 后者已经是现代开发标准                                                                       |
| api        | 基于 callback 的异步回调   | 基于 promise，并且可使用 async | 后者已经是现代开发标准                                                                       |
| npm        | 部分支持                   | 支持                           | 前者有限制，不支持 nodejs 的核心库                                                           |
| 工具       | 微信官方开发者工具, VSCode | VSCode                         | 无太大差异，用了 vscode 之后依然有部分工作需要在微信开发者工具里面进行，如编译和项目设置     |
| 组件写法   | 基于 JS 对象的配置形式     | 基于 class 形式                | 后者写法更简洁                                                                               |
| 组件间通信 | 属性、事件，globalData     | 属性                           | 两者在处理父子或子父之间通信无太大区别，但是兄弟之间或者跨页面之间都需要借助其他手段         |

上述表格是对于日常开发中体验做了个基本对比，**Taro**是拥抱现代 web 开发体系，而小程序有部分还停留在原来的时代，所以开发体验和效率上**Taro**占优，但是优势并不是特别大；开发愉悦度相比原生要高不少，项目可维护性和问题排查上占优比较大（在项目比较大的情况下）。

另外，关于学习而言，对于两个技术方案，都需要重新学习，学习成本两者差不多，但是如果要基于 Taro 做小程序开发，那依然需要去熟悉除特定语法和组件以外的小程序框架体系和开放能力，所以 Taro 这边会需要多学习不少东西。而 Taro 本身基于的**React 语法**是比较容易上手的，上手难度低于字符串模板，Taro 未来如果要跨组件通信我们可能会选择 redux，这个库会需要一点时间去适应，相比之下原生小程序的跨组件通信方案可能就更简单粗暴一些，但是 globalData 也更容易失控。

### 稳定性

Taro 的编译目标是小程序原生代码，所以小程序平台本身如果存在问题，那 Taro 一样也会存在；另外一方面，因为 Taro 是在原生小程序上面的一层抽象，所以势必在转换的过程中存在一些没考虑到或者由于某些限制而处理的不好的地方，所以就这一点，Taro 是有风险的。所以讨论稳定性，我们就是在讨论 taro 的稳定性。目前 Taro 基本上每周一个版本。

使用 Taro 开发的上线案例里面目前除了京东自家的几个小程序(京东购物、toplife、京品百货等 7 个小程序)以外，并没有看到主流互联网公司的作品（大厂这边基本上都有自己的小程序开发方案上生产）。

**Taro**从去年 4 月 8 日开源以来，Github 上面打开的 issue 为 465 个，已关闭 2788 个，star 数量 20270 个，主要开发者约 7 人。

### 社区支持

小程序原生开发有官方社区，有人会解答问题，解答者应该都是非技术出身，基本只能解答业务性的问题，但是由于原生开发者数量庞大，所以想要获取问题的解决方案，百度谷歌能搜索到足够多的资源；另外一方面 Taro 的技术性问题都可以在 github 询问，解答速度基本上要以天为单位，而网络上能找到的解决方案并不多，严重依赖于官方的效率和开发交流群的质量。就这一点而言，原生开发肯定是占优的。

### 跨平台

考虑运营推广，多一个平台多一个入口是有利的。但是就目前 Taro 的能力而言，微信小程序和 H5 的支持算比较好的，百度小程序和头条小程序都存在部分缺陷；结合我们的一些业务场景和流程而言，H5 对我们又是有一定作用的，例如用户通过呼叫中心接入，客服下单，可以推送一条短信给用户，短信里面包含一个链接，用户可以通过该链接直接跳转到 H5 的待支付订单页完成支付，另外 H5 有极强的可移植性，我们甚至可以把 H5 嵌入到其他小程序平台或者快应用。基于上述理由，我认为我们有跨平台的需求，至少要有一个 H5 的平台。

### 风险

Taro 本身依然还是有些限制，所以很可能会存在一些技术的坑，而这些坑可能有一部分是无法通过其他方案绕过去，很可能要涉及到编译这一层，如果是这种问题的话我们基本上就只能等官方修复，就目前而言，在社区还未看到微信小程序这边存在这种问题。加之京东官方的京东购物是用**Taro**开发的，我认为 Taro 的一些问题或者坑应该还是在一个可控的范围内。

## 结论

基于以上的分析，再结合我本人之前做过 React，对 Taro 这一套方案是比较熟悉的，所以我个人推荐选择 Taro 作为我们未来的小程序开发方案。
